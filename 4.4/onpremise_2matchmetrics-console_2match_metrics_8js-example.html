<!-- HTML header for doxygen 1.8.15-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>51Degrees Device Detection Node.js: onpremise/matchmetrics-console/matchMetrics.js</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="examplegrabber.js"></script>
<script type="text/javascript" src="testedversionsgrabber.js"></script>
<script type="text/javascript" src="search51.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="docs-main.min.css" rel="stylesheet" type="text/css" />
</head>
<body class="l-docs-index p-doxygen">
<div class="l-index__content">
<!--div id="top"--><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea" class="g-header g-header--docs">
  <h1 class="c-brand">
  <a id="projectlogo" href="../../documentation/4.4/index.html" class="c-brand__link"><img class="c-brand__image" alt="Logo" src="logo-51Degrees-Docs.png" style="width:172px;"/></a>
  <span class="c-tagline">51Degrees Device Detection Node.js
   &#160;<span id="projectnumber">4.4</span>
  </span>
  </h1>
  <div id="projectalign" style="padding-left: 0.5em;">
   <div id="projectbrief">51Degrees Device Detection for Node.js</div>
  </div>
  <div id="main-nav"></div>
  <section class="g-search">
    <div class="c-search is-openable" id="searchOpenable">
    <form class="c-search__form">
      <div class="b-form-group b-form-group--with-icon">
        <label for="inputSearch" class="b-text--hidden">Search</label>
        <img src="icon-search.svg" class="b-icon" alt="Search" />
        <input type="text" class="c-search__input" id="inputSearch" onkeyup="javascript:onSearch(this,event.keyCode)" placeholder="Search" aria-label="Search">
      </div>
    </form>
    <div class="c-search__content" id="searchContent">
    </div>
  </div> 
  </section>
</div>
<!-- end header part -->
<main class="g-main">
<!-- Generated by Doxygen 1.8.15 -->
<!-- top -->
	<div class="g-docs__sidenav">																														         <nav id="nav-tree-contents" class="c-sidenav">																														     <h4 class="c-sidenav__heading">Documentation</h4>																									         <div id="nav-sync" class="sync"></div>
  <ul class="c-sidenav__list">																														     </ul>																																				   </nav>    </div><script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('onpremise_2matchmetrics-console_2match_metrics_8js-example.html','');});
/* @license-end */
</script>
<div id="doc-content" class="g-docs__content">
<div class="g-docs__header">
<h2 class="g-docs__page-title">onpremise/matchmetrics-console/matchMetrics.js</h2></div><!--header-->
<div class="g-docs__inner">
<div class="g-docs__primary" id="primary">
<p>The example illustrates the various metrics that can be obtained about the device detection process, for example, the degree of certainty about the result. Running the example outputs those properties and values.</p>
<p>The example also illustrates controlling properties that are returned from the detection process - reducing the number of components required to return the properties requested reduces the overall time taken.</p>
<p>There is a <a href="https://51degrees.com/documentation/_device_detection__hash.html#DeviceDetection_Hash_DataSetProduction_Performance">discussion</a> of metrics and controlling performance on our web site. See also the <a href="https://51degrees.com/documentation/_device_detection__features__performance_options.html">performance options</a> page.</p>
<p>This example is available in full on <a href="https://github.com/51Degrees/device-detection-node/blob/master/fiftyone.devicedetection.onpremise/examples/onpremise/matchmetrics-console/matchMetrics.js">GitHub</a>.</p>
<div class="c-code__block c-code__block--outline"><div class="c-code__line"><span class="c-code__comment">/* *********************************************************************</span></div><div class="c-code__line"><span class="c-code__comment"> * This Original Work is copyright of 51 Degrees Mobile Experts Limited.</span></div><div class="c-code__line"><span class="c-code__comment"> * Copyright 2023 51 Degrees Mobile Experts Limited, Davidson House,</span></div><div class="c-code__line"><span class="c-code__comment"> * Forbury Square, Reading, Berkshire, United Kingdom RG1 3EU.</span></div><div class="c-code__line"><span class="c-code__comment"> *</span></div><div class="c-code__line"><span class="c-code__comment"> * This Original Work is licensed under the European Union Public Licence</span></div><div class="c-code__line"><span class="c-code__comment"> * (EUPL) v.1.2 and is subject to its terms as set out below.</span></div><div class="c-code__line"><span class="c-code__comment"> *</span></div><div class="c-code__line"><span class="c-code__comment"> * If a copy of the EUPL was not distributed with this file, You can obtain</span></div><div class="c-code__line"><span class="c-code__comment"> * one at https://opensource.org/licenses/EUPL-1.2.</span></div><div class="c-code__line"><span class="c-code__comment"> *</span></div><div class="c-code__line"><span class="c-code__comment"> * The &#39;Compatible Licences&#39; set out in the Appendix to the EUPL (as may be</span></div><div class="c-code__line"><span class="c-code__comment"> * amended by the European Commission) shall be deemed incompatible for</span></div><div class="c-code__line"><span class="c-code__comment"> * the purposes of the Work and the provisions of the compatibility</span></div><div class="c-code__line"><span class="c-code__comment"> * clause in Article 5 of the EUPL shall not apply.</span></div><div class="c-code__line"><span class="c-code__comment"> *</span></div><div class="c-code__line"><span class="c-code__comment"> * If using the Work as, or as part of, a network application, by</span></div><div class="c-code__line"><span class="c-code__comment"> * including the attribution notice(s) required under Article 5 of the EUPL</span></div><div class="c-code__line"><span class="c-code__comment"> * in the end user terms of the application under an appropriate heading,</span></div><div class="c-code__line"><span class="c-code__comment"> * such notice(s) shall fulfill the requirements of that article.</span></div><div class="c-code__line"><span class="c-code__comment"> * ********************************************************************* */</span></div><div class="c-code__line"></div><div class="c-code__line"><span class="c-code__keyword">const</span> path = require(<span class="c-code__stringliteral">&#39;path&#39;</span>);</div><div class="c-code__line"><span class="c-code__keyword">const</span> require51 = (requestedPackage) =&gt; {</div><div class="c-code__line">  <span class="c-code__keywordflow">try</span> {</div><div class="c-code__line">    <span class="c-code__keywordflow">return</span> require(path.join(__dirname, <span class="c-code__stringliteral">&#39;/../../../node_modules/&#39;</span>, requestedPackage));</div><div class="c-code__line">  } <span class="c-code__keywordflow">catch</span> (e) {</div><div class="c-code__line">    <span class="c-code__keywordflow">return</span> require(path.join(__dirname, <span class="c-code__stringliteral">&#39;/../../../../&#39;</span>, requestedPackage));</div><div class="c-code__line">  }</div><div class="c-code__line">};</div><div class="c-code__line"></div><div class="c-code__line"><span class="c-code__keyword">const</span> fs = require(<span class="c-code__stringliteral">&#39;fs&#39;</span>);</div><div class="c-code__line"></div><div class="c-code__line"><span class="c-code__keyword">const</span> <a name="_a0"></a><a class="code" href="class_device_detection_on_premise_pipeline_builder.html">DeviceDetectionOnPremisePipelineBuilder</a> =</div><div class="c-code__line">  require51(<span class="c-code__stringliteral">&#39;fiftyone.devicedetection.onpremise&#39;</span>).DeviceDetectionOnPremisePipelineBuilder;</div><div class="c-code__line"></div><div class="c-code__line"><span class="c-code__keyword">const</span> <a name="_a1"></a><a class="code" href="class_example_utils.html">ExampleUtils</a> = require(path.join(__dirname, <span class="c-code__stringliteral">&#39;/../exampleUtils&#39;</span>)).<a class="code" href="class_example_utils.html">ExampleUtils</a>;</div><div class="c-code__line"><span class="c-code__keyword">const</span> exampleConstants = require51(<span class="c-code__stringliteral">&#39;fiftyone.devicedetection.shared&#39;</span>).exampleConstants;</div><div class="c-code__line"></div><div class="c-code__line"><span class="c-code__comment">// In this example, by default, the 51degrees &quot;Lite&quot; file needs to be in the</span></div><div class="c-code__line"><span class="c-code__comment">// fiftyone.devicedetection.onpremise/device-detection-cxx/device-detection-data,</span></div><div class="c-code__line"><span class="c-code__comment">// or you may specify another file as a command line parameter.</span></div><div class="c-code__line"><span class="c-code__comment">//</span></div><div class="c-code__line"><span class="c-code__comment">// Note that the Lite data file is only used for illustration, and has</span></div><div class="c-code__line"><span class="c-code__comment">// limited accuracy and capabilities.</span></div><div class="c-code__line"><span class="c-code__comment">// Find out about the Enterprise data file on our pricing page:</span></div><div class="c-code__line"><span class="c-code__comment">// https://51degrees.com/pricing</span></div><div class="c-code__line"><span class="c-code__keyword">const</span> LITE_V_4_1_HASH = <span class="c-code__stringliteral">&#39;51Degrees-LiteV4.1.hash&#39;</span>;</div><div class="c-code__line"></div><div class="c-code__line"><span class="c-code__comment">// Here we make a function that gets a userAgent as evidence and</span></div><div class="c-code__line"><span class="c-code__comment">// uses the Device Detection Engine to detect if it is a mobile or not</span></div><div class="c-code__line"><span class="c-code__keyword">const</span> displayMatchMetrics = async <span class="c-code__keyword">function</span> (pipeline, output, evidenceValues) {</div><div class="c-code__line">  <span class="c-code__comment">// Create a FlowData element</span></div><div class="c-code__line">  <span class="c-code__comment">// This is used to add evidence and process it through the FlowElements in the Pipeline.</span></div><div class="c-code__line">  <span class="c-code__keyword">const</span> flowData = pipeline.createFlowData();</div><div class="c-code__line"></div><div class="c-code__line">  <span class="c-code__comment">// Add the evidence to set the values for user-agent, sec-ch-* headers, etc.</span></div><div class="c-code__line">  evidenceValues.forEach((value, key, map) =&gt; {</div><div class="c-code__line">    flowData.evidence.add(key, value);</div><div class="c-code__line">  });</div><div class="c-code__line"></div><div class="c-code__line">  <span class="c-code__comment">// Run process on the flowData (this returns a promise)</span></div><div class="c-code__line">  await flowData.process();</div><div class="c-code__line"></div><div class="c-code__line">  <span class="c-code__keyword">const</span> device = flowData.device;</div><div class="c-code__line"></div><div class="c-code__line">  <span class="c-code__comment">// list the evidence</span></div><div class="c-code__line">  output.write(<span class="c-code__stringliteral">&#39;--- Compare evidence with what was matched ---\n\n&#39;</span>);</div><div class="c-code__line">  output.write(<span class="c-code__stringliteral">&#39;Evidence\n&#39;</span>);</div><div class="c-code__line"></div><div class="c-code__line">  <span class="c-code__comment">// output the evidence in reverse value length order</span></div><div class="c-code__line">  <span class="c-code__keyword">const</span> sortedEvidence = <a class="code" href="class_example_utils.html">ExampleUtils</a>.<a name="a2"></a>sortMap(</div><div class="c-code__line">    evidenceValues,</div><div class="c-code__line">    (a, b) =&gt; { <span class="c-code__keywordflow">return</span> a[1].length - b[1].length; });</div><div class="c-code__line">  sortedEvidence.forEach((value, key, map) =&gt; {</div><div class="c-code__line">    output.write(`\t${key.padEnd(34)}: ${value}\n`);</div><div class="c-code__line">  });</div><div class="c-code__line"></div><div class="c-code__line">  <span class="c-code__comment">// Obtain the matched User-Agents: the matched substrings in the</span></div><div class="c-code__line">  <span class="c-code__comment">// User-Agents are separated with underscores - output in forward length order.</span></div><div class="c-code__line">  output.write(<span class="c-code__stringliteral">&#39;Matches\n&#39;</span>);</div><div class="c-code__line">  device.userAgents.value.sort((a, b) =&gt; { <span class="c-code__keywordflow">return</span> b.length - a.length; })</div><div class="c-code__line">    .forEach((u) =&gt; { output.write(`\t${<span class="c-code__stringliteral">&#39;Matched Chars&#39;</span>.padEnd(34)}: ${u}\n`); });</div><div class="c-code__line"></div><div class="c-code__line">  output.write(<span class="c-code__charliteral">&#39;\n&#39;</span>);</div><div class="c-code__line"></div><div class="c-code__line">  output.write(<span class="c-code__stringliteral">&#39;--- Listing all available properties, by component, by property name ---\n&#39;</span>);</div><div class="c-code__line">  output.write(`For a discussion of what the match properties mean, see: </div><div class="c-code__line">https:<span class="c-code__comment">//51degrees.com/documentation/_device_detection__hash.html#DeviceDetection_Hash_DataSetProduction_Performance\n`);</span></div><div class="c-code__line"></div><div class="c-code__line">  <span class="c-code__comment">// Get the properties available from the DeviceDetection engine.</span></div><div class="c-code__line">  <span class="c-code__keyword">const</span> availableProperties = Object.entries(device.flowElement.properties);</div><div class="c-code__line"></div><div class="c-code__line">  <span class="c-code__comment">// create a Map keyed on the component name of the properties available</span></div><div class="c-code__line">  <span class="c-code__comment">// components being hardware, browser, OS and Crawler.</span></div><div class="c-code__line">  <span class="c-code__comment">// There is also a additional &#39;Metrics&#39; component, which is added for the match metrics.</span></div><div class="c-code__line">  <span class="c-code__keyword">const</span> componentMap = groupBy(</div><div class="c-code__line">    <span class="c-code__comment">// We&#39;ve already handled the matched user agents property above so exclude it here.</span></div><div class="c-code__line">    availableProperties.filter(p =&gt; p !== <span class="c-code__keyword">null</span> &amp;&amp; p[0] !== <span class="c-code__stringliteral">&#39;userAgents&#39;</span>),</div><div class="c-code__line">    <span class="c-code__comment">// We want to group on component name.</span></div><div class="c-code__line">    p =&gt; p[1] == <span class="c-code__keyword">null</span> || p[1].component == <span class="c-code__keyword">null</span> ? <span class="c-code__stringliteral">&#39;Unknown&#39;</span> : p[1].component.name);</div><div class="c-code__line"></div><div class="c-code__line">  <span class="c-code__comment">// iterate the map created above</span></div><div class="c-code__line">  componentMap.forEach((properties, componentName, map) =&gt; {</div><div class="c-code__line">    output.write(`${componentName}\n`);</div><div class="c-code__line">    properties.forEach(property =&gt; {</div><div class="c-code__line">      <span class="c-code__comment">// while we get the available properties and their metadata</span></div><div class="c-code__line">      <span class="c-code__comment">// from the pipeline ...</span></div><div class="c-code__line">      <span class="c-code__keyword">const</span> propertyName = <span class="c-code__keyword">property</span>[0];</div><div class="c-code__line">      <span class="c-code__keyword">const</span> propertyDesc = <span class="c-code__keyword">property</span>[1].description;</div><div class="c-code__line">      <span class="c-code__comment">// ... we get the values for the last detection from flowData</span></div><div class="c-code__line">      <span class="c-code__keyword">const</span> value = device[propertyName];</div><div class="c-code__line"></div><div class="c-code__line">      <span class="c-code__comment">// Output property names, values and descriptions.</span></div><div class="c-code__line">      <span class="c-code__keyword">const</span> valueText = value.hasValue ? value.value : `unknown (${value.noValueMessage})`;</div><div class="c-code__line">      output.write(`\t${propertyName.padEnd(24)}: ${valueText}\n`);</div><div class="c-code__line">      output.write(`\t\t${propertyDesc}\n`);</div><div class="c-code__line">    });</div><div class="c-code__line"></div><div class="c-code__line">    output.write(<span class="c-code__charliteral">&#39;\n&#39;</span>);</div><div class="c-code__line">  });</div><div class="c-code__line">};</div><div class="c-code__line"></div><div class="c-code__line"><span class="c-code__keyword">const</span> groupBy = <span class="c-code__keyword">function</span> (list, keyGetter) {</div><div class="c-code__line">  <span class="c-code__keyword">const</span> map = <span class="c-code__keyword">new</span> Map();</div><div class="c-code__line">  list.forEach((item) =&gt; {</div><div class="c-code__line">    <span class="c-code__keyword">const</span> key = keyGetter(item);</div><div class="c-code__line">    <span class="c-code__keyword">const</span> collection = map.get(key);</div><div class="c-code__line">    <span class="c-code__keywordflow">if</span> (!collection) {</div><div class="c-code__line">      map.set(key, [item]);</div><div class="c-code__line">    } <span class="c-code__keywordflow">else</span> {</div><div class="c-code__line">      collection.push(item);</div><div class="c-code__line">    }</div><div class="c-code__line">  });</div><div class="c-code__line">  <span class="c-code__keywordflow">return</span> map;</div><div class="c-code__line">};</div><div class="c-code__line"></div><div class="c-code__line"><span class="c-code__keyword">const</span> findDataFile = <span class="c-code__keyword">function</span> (dataFile, output) {</div><div class="c-code__line">  <span class="c-code__comment">// No filename specified use the default</span></div><div class="c-code__line">  <span class="c-code__keywordflow">if</span> (dataFile === <span class="c-code__keyword">null</span>) {</div><div class="c-code__line">    dataFile = LITE_V_4_1_HASH;</div><div class="c-code__line">    output.write(`No filename specified. Using <span class="c-code__keywordflow">default</span> <span class="c-code__stringliteral">&#39;${dataFile}&#39;</span>\n`);</div><div class="c-code__line">  }</div><div class="c-code__line"></div><div class="c-code__line">  <span class="c-code__comment">// Work out where the data file is if we don&#39;t have an absolute path.</span></div><div class="c-code__line">  <span class="c-code__keywordflow">if</span> (path.isAbsolute(dataFile) === <span class="c-code__keyword">false</span>) {</div><div class="c-code__line">    dataFile = <a class="code" href="class_example_utils.html">ExampleUtils</a>.<a name="a3"></a>findFile(dataFile);</div><div class="c-code__line">  }</div><div class="c-code__line"></div><div class="c-code__line">  <span class="c-code__keywordflow">if</span> (dataFile === <span class="c-code__keyword">null</span> || typeof dataFile === <span class="c-code__stringliteral">&#39;undefined&#39;</span> || fs.existsSync(dataFile) === <span class="c-code__keyword">false</span>) {</div><div class="c-code__line">    output.write(`Failed to find a device detection data file. If <span class="c-code__keyword">using</span> the <span class="c-code__keywordflow">default</span> <span class="c-code__stringliteral">&#39;lite&#39;</span></div><div class="c-code__line"> data file, make sure that git lfs is installed and that the device-detection-data</div><div class="c-code__line"> submodule has been updated by running <span class="c-code__stringliteral">&#39;git submodule update --recursive&#39;</span>.\n`);</div><div class="c-code__line">    <span class="c-code__keywordflow">throw</span> <span class="c-code__keyword">new</span> Error(`Data file <span class="c-code__stringliteral">&#39;${dataFile}&#39;</span> not found`);</div><div class="c-code__line">  }</div><div class="c-code__line"></div><div class="c-code__line">  <span class="c-code__keywordflow">return</span> dataFile;</div><div class="c-code__line">};</div><div class="c-code__line"></div><div class="c-code__line"><span class="c-code__keyword">const</span> run = async <span class="c-code__keyword">function</span> (dataFile, output, evidenceList) {</div><div class="c-code__line">  dataFile = findDataFile(dataFile, output);</div><div class="c-code__line"></div><div class="c-code__line">  <span class="c-code__comment">// In this example, we use the DeviceDetectionOnPremisePipelineBuilder</span></div><div class="c-code__line">  <span class="c-code__comment">// and configure it in code. For more information about</span></div><div class="c-code__line">  <span class="c-code__comment">// pipelines in general see the documentation at</span></div><div class="c-code__line">  <span class="c-code__comment">// https://51degrees.com/documentation/_concepts__configuration__builders__index.html</span></div><div class="c-code__line">  <span class="c-code__keyword">const</span> pipeline = <span class="c-code__keyword">new</span> <a class="code" href="class_device_detection_on_premise_pipeline_builder.html">DeviceDetectionOnPremisePipelineBuilder</a>({</div><div class="c-code__line">    dataFile,</div><div class="c-code__line">    <span class="c-code__comment">// Prefer low memory profile where all data streamed from disk on-demand.</span></div><div class="c-code__line">    performanceProfile: <span class="c-code__stringliteral">&#39;LowMemory&#39;</span>,</div><div class="c-code__line">    <span class="c-code__comment">// Disable share usage for this example.</span></div><div class="c-code__line">    shareUsage: <span class="c-code__keyword">false</span>,</div><div class="c-code__line">    <span class="c-code__comment">// inhibit auto-update of the data file for this test</span></div><div class="c-code__line">    autoUpdate: <span class="c-code__keyword">false</span>,</div><div class="c-code__line">    updateOnStart: <span class="c-code__keyword">false</span>,</div><div class="c-code__line">    fileSystemWatcher: <span class="c-code__keyword">false</span>,</div><div class="c-code__line">    <span class="c-code__comment">// You can improve matching performance by specifying only those properties you wish to use.</span></div><div class="c-code__line">    <span class="c-code__comment">// If you don&#39;t specify any properties you will get all those available in the data file tier</span></div><div class="c-code__line">    <span class="c-code__comment">// that you have used. The free &quot;Lite&quot; tier contains fewer than 20. Since we are specifying</span></div><div class="c-code__line">    <span class="c-code__comment">// properties here, we will only see those properties, along with the match metric properties</span></div><div class="c-code__line">    <span class="c-code__comment">// in the output.</span></div><div class="c-code__line">    <span class="c-code__comment">//</span></div><div class="c-code__line">    <span class="c-code__comment">// If using the full on-premise data file the hardwarename property will be present in the</span></div><div class="c-code__line">    <span class="c-code__comment">// data file. See https://51degrees.com/pricing</span></div><div class="c-code__line">    <span class="c-code__comment">//</span></div><div class="c-code__line">    <span class="c-code__comment">// The &#39;ismobile&#39; and &#39;hardwarename&#39; properties are both part of the &#39;hardware&#39; component.</span></div><div class="c-code__line">    <span class="c-code__comment">// The remaining properties are from match metrics.</span></div><div class="c-code__line">    <span class="c-code__comment">// Uncomment &#39;browsername&#39; to include Browser component as well. This can be seen by looking</span></div><div class="c-code__line">    <span class="c-code__comment">// for the browser profile ID in the device ID value.</span></div><div class="c-code__line">    restrictedProperties: [<span class="c-code__stringliteral">&#39;ismobile&#39;</span>, <span class="c-code__stringliteral">&#39;hardwarename&#39;</span>, <span class="c-code__stringliteral">&#39;userAgents&#39;</span>, <span class="c-code__stringliteral">&#39;deviceID&#39;</span>, <span class="c-code__stringliteral">&#39;difference&#39;</span>, <span class="c-code__stringliteral">&#39;method&#39;</span>, <span class="c-code__stringliteral">&#39;matchedNodes&#39;</span>, <span class="c-code__stringliteral">&#39;drift&#39;</span>, <span class="c-code__stringliteral">&#39;iterations&#39;</span>], <span class="c-code__comment">/* , &#39;browsername&#39; */</span></div><div class="c-code__line">    <span class="c-code__comment">// We want to show the matching evidence characters as part of this example, so we have to set</span></div><div class="c-code__line">    <span class="c-code__comment">// this flag to true.</span></div><div class="c-code__line">    updateMatchedUserAgent: <span class="c-code__keyword">true</span></div><div class="c-code__line">  }).build();</div><div class="c-code__line"></div><div class="c-code__line">  <span class="c-code__comment">// To monitor the pipeline we can put in listeners for various log events.</span></div><div class="c-code__line">  <span class="c-code__comment">// Valid types are info, debug, warn, error</span></div><div class="c-code__line">  pipeline.on(<span class="c-code__stringliteral">&#39;error&#39;</span>, console.error);</div><div class="c-code__line"></div><div class="c-code__line">  <a class="code" href="class_example_utils.html">ExampleUtils</a>.<a name="a4"></a>checkDataFile(pipeline, dataFile);</div><div class="c-code__line"></div><div class="c-code__line">  <span class="c-code__comment">// carry out some sample detections</span></div><div class="c-code__line">  <span class="c-code__keywordflow">for</span> (<span class="c-code__keyword">const</span> evidenceValues of evidenceList) {</div><div class="c-code__line">    await displayMatchMetrics(pipeline, output, evidenceValues);</div><div class="c-code__line">  }</div><div class="c-code__line">};</div><div class="c-code__line"></div><div class="c-code__line"><span class="c-code__comment">// Don&#39;t run the server if under TEST</span></div><div class="c-code__line"><span class="c-code__keywordflow">if</span> (process.env.JEST_WORKER_ID === undefined) {</div><div class="c-code__line">  <span class="c-code__keyword">const</span> args = process.argv.slice(2);</div><div class="c-code__line">  <span class="c-code__comment">// Use the data file location supplied on the command line. The logic within the run function</span></div><div class="c-code__line">  <span class="c-code__comment">// will handle null values and finding the file is a relative path is supplied.</span></div><div class="c-code__line">  <span class="c-code__keyword">const</span> dataFile = args.length &gt; 0 ? args[0] : <span class="c-code__keyword">null</span>;</div><div class="c-code__line"></div><div class="c-code__line">  <span class="c-code__comment">// Just take the third entry from the default evidence values.</span></div><div class="c-code__line">  run(dataFile, process.stdout, exampleConstants.defaultEvidenceValues.slice(2, 3));</div><div class="c-code__line">};</div><div class="c-code__line"></div><div class="c-code__line">module.exports = {</div><div class="c-code__line">  run</div><div class="c-code__line">};</div></div> </div><!-- primary -->
</div><!-- inner-->
<!-- HTML footer for doxygen 1.8.15-->
<!-- start footer part -->
<section id="nav-path" class="g-footer g-footer--docs"><!-- id is needed for treeview function! -->
    <p class="g-footer__copyright">Generated by
    <a href="http://www.doxygen.org/index.html">
    <b>doxygen</b></a> 1.8.15
  </p>
</section>
</div>
</main>
</div>
</body>
</html>
